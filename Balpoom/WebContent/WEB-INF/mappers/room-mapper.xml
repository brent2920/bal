<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="room">

<!-- Parameter Type / Result Type은 필요에 따라 추가 -->
	<insert id="insertList" parameterType="java.util.HashMap">
		insert into room values(#{sell_num},#{b_title},#{b_deposit},
		#{b_mpay},#{b_rkind},#{b_floor},#{b_size},#{b_gpay},#{b_glist},
		#{b_eleve},#{b_parking},#{b_rinfo},#{b_enterdate},'불가능',
		#{b_option},#{b_detail},#{b_location},#{b_nstation},
		#{b_latitude},#{b_longitude},#{b_petpossible},#{id},0,0,
		#{b_local1},#{b_local2},#{b_local3},#{b_size_m2},#{b_floor_all})
		
	</insert>
	
	<insert id="insertOne">
	
	</insert>
	
	
	<select id="getRoomInfo" resultType="java.util.HashMap" parameterType="java.lang.Integer">
		select * from room where SELL_NUM = #{regNum}
	</select>

	<select id="getRoomList"  resultType="java.util.HashMap" parameterType="java.util.HashMap">
		SELECT * FROM ROOM WHERE
			<choose>
				<when test="#{mKind} == 'jPay'">
					B_MPAY = 0 AND
				</when>
				<when test="#{mKind} == 'mPay'">
					B_MPAY <![CDATA[>]]> 0 AND
				</when>
			</choose>
			
			<choose>
				<when test="#{rKind} == 'one_open'">
					B_RKIND='원룸(오픈형)' AND
				</when>
				<when test="#{rKind} == 'one_seperate'">
					B_RKIND='원룸(분리형)' AND
				</when>
				<when test="#{rKind} == 'one_dfloor'">
					B_RKIND='원룸(복층형)' AND
				</when>
				<when test="#{rKind} == 'two_room'">
					B_RKIND='투룸' AND
				</when>
				<when test="#{rKind} == 'gt_three'">
					B_RKIND='쓰리룸+' AND
				</when>
			</choose>
			 
			B_DEPOSIT BETWEEN #{deposit_from} AND #{deposit_to} AND
			B_MPAY BETWEEN #{mpay_from} AND #{mpay_to} 
			
			<if test="#{parking} != 'all'">
				AND B_PARKING='가능'
			</if>
			
			<if test="#{pet} != 'all'">
				AND B_PETPOSSIBLE='가능'
			</if>
			
			<if test="#{lhok} != 'all'">
				AND B_LHOK='가능'
			</if>
			
			<choose>
				<when test="#{area} == 1">
					AND B_SIZE <![CDATA[<]]> 5
				</when>
				<when test="#{area} == 2">
					AND B_AREA BETWEEN 5 AND 10
				</when>
				<when test="#{area} == 3">
					AND B_AREA <![CDATA[>]]> 10
				</when>
			</choose>
			
			<choose>
				<when test="#{floor} == 'underground'">
					AND B_FLOOR = '반지하'
				</when>
				<when test="#{floor} == 'low_floor'">
					AND B_FLOOR in('1층', '2층', '3층');
				</when>
				<when test="#{floor} == 'mid_floor'">
					AND B_FLOOR in('4층', '5층', '6층');
				</when>
				<when test="#{floor} == 'high_floor'">
					AND B_FLOOR not in('반지하', '1층', '2층', '3층', '4층', '5층', '6층')
				</when>
			</choose>
			
			AND B_LATITUDE BETWEEN #{south} AND #{north}
			AND B_LONGITUDE BETWEEN #{east} AND #{west}
	</select>

	<select id="room_deposit"  resultType="java.util.HashMap">
		select * from ROOM where B_DEPOSIT=1000
	</select>


</mapper>
